<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <script type="text/javascript" src="./token-negotiator-dist/negotiator.js"></script>
  <link rel="stylesheet" href="./token-negotiator-dist/theme/style.css" />
</head>

<body onload="init()">
  <button onclick="switchTheme()">Switch theme</button>
  <button onclick="reloadIssuers()">Reload</button>
  <div class="overlay-tn"></div>
  <script>
    var theme = "light";
    function init() {
      window.negotiator = new negotiator.Client({
        type: "active",
        issuers: [
          {
            onChain: true,
            fungible: true,
            chain: "eth",
            blockchain: "evm",
            collectionID: "socios",
            contract: "0x3506424F91fD33084466F402d5D97f05F8e3b4AF",
            oAuth2options: {
              consumerKey: "PBK9Mx_ffFRUPHW9BLTxnGHRdywa",
              partnerTag: "smarttokenlabs",
              endpoints: {
                redirectURI: {
                  path: "http://localhost:5000/user-login-callback",
                  params: {}
                },
                userBalance: {
                  path: 'http://localhost:5000/user-balance',
                  params: {}
                },
                userNfts: {
                  path: 'http://localhost:5000/user-nfts',
                  params: {}
                },
              },
            },
          },
          {
            onChain: true,
            fungible: true,
            chain: "eth",
            blockchain: "evm",
            collectionID: "socios",
            contract: "0x3506424F91fD33084466F402d5D97f05F8e3b4AF",
            oAuth2options: {
              consumerKey: "PBK9Mx_ffFRUPHW9BLTxnGHRdywa",
              partnerTag: "smarttokenlabs",
              endpoints: {
                redirectURI: {
                  path: "http://localhost:5000/user-login-callback",
                  params: {}
                },
                userBalance: {
                  path: 'http://localhost:5000/user-balance',
                  params: {}
                },
                userNfts: {
                  path: 'http://localhost:5000/user-nfts',
                  params: {}
                },
              },
            },
          },
        ],
        uiOptions: {
          openingHeading:
            "Open a new world of perks, benefits and opportunities with your attestation, collectible or token.",
          issuerHeading: "Get discount with Ticket",
          repeatAction: "try again",
          theme: theme,
          position: "top-right",
        },
        unSupportedUserAgent: {
          authentication: {
            config: {
              metaMaskAndroid: true,
              alphaWalletAndroid: true,
              mewAndroid: true,
              imTokenAndroid: true,
            },
            errorMessage:
              "No Support for Authentication with this user agent. Try Chrome, Safari or Edge instead.",
          },
          full: {
            config: {
              iE: true,
              iE9: true,
            },
            errorMessage:
              "This browser is not supported. Please try using Chrome, Edge, FireFox or Safari.",
          },
        },
        safeConnectOptions: {
          url: "https://safeconnect.tokenscript.org",
          initialProof: false,
        },
        experimentalFeatures: ["magicLinkWallet"],
      });

      window.negotiator.on("tokens-selected", (tokens) => {
        console.log("tokens-selected", tokens);
      });
      window.negotiator.on("connected-wallet", (wallet) => {
        console.log("connected wallet", wallet);
        window.testingWallet = wallet;
      });
      window.negotiator.on("network-change", (chain) => {
        console.log("network change", chain);
        window.testingChain = chain;
      });
      window.negotiator.on("disconnected-wallet", () => {
        console.log("wallet successfully disconnected");
      });
      window.negotiator.on("loaded", () => {
        console.log("token negotiator loaded");
      });
      window.negotiator.on("tokens-refreshed", () => {
        console.log("tokens-refreshed");
      });
      window.negotiator.on("opened-overlay", () => {
        console.log("opened overlay");
      });
      window.negotiator.on("closed-overlay", () => {
        console.log("closed overlay");
      });
      window.negotiator.on("view-changed", (data) => {
        console.log("view change", data);
      });
      window.negotiator.on("token-proof", (proof) => {
        console.log(proof);
      });

      window.negotiator.on("tokens-loaded", (data) => {
        console.log(`${data.loadedCollections} tokens were loaded`);
      });

      window.negotiator.negotiate();
    }

    function reloadIssuers() {
      window.negotiator.negotiate([
        {
          collectionID: "penthouse-panther-club",
          collectionAddress:
            "ff846ef2eed57e5367cf8826e63f4d53fe28d28aa67417accb6e4b48cbd19136",
          updateAuthority: "92oYPmrr1BHznizuZmpKZ3MFRadMFYRTCxo9Pf34mZKX",
          tokenProgram: "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
          onChain: true,
          symbol: "PPC",
          chain: "mainnet",
          blockchain: "solana",
        },
        {
          hideToggle: false,
          collectionID: "pixel",
          collectionAddress:
            "166424b16c4c7f40eb852f9eb2d0d6869a9ed7ac54a8e6afbd516676bfbbeb19",
          onChain: true,
          symbol: "PIXEL",
          chain: "mainnet",
          blockchain: "solana",
        },
        // {
        //   onChain: true,
        //   collectionID: "expansion-punks",
        //   contract: "0x0d0167a823c6619d430b1a96ad85b888bcf97c37",
        //   chain: "eth",
        //   blockchain: "evm",
        // },
        {
          onChain: true,
          collectionID: "fantom-collection-test",
          contract: "0x94e22c14118353651636f9af43cd0a5a08b93da3",
          chain: "fantom",
          blockchain: "evm",
        },
        {
          hideToggle: true,
          noTokenMsg:
            "<p>If you have a token please:</p><p>1. Open your magic link inside this browser.<br/>2. Refresh this page.</p>",
          onChain: true,
          collectionID: "bsc-collection-test",
          contract: "0xF5db804101d8600c26598A1Ba465166c33CdAA4b",
          chain: "bsc",
          blockchain: "evm",
        },
        {
          onChain: true,
          collectionID: "tt",
          contract: "0x76be3b62873462d2142405439777e971754e8e77",
          chain: "eth",
          blockchain: "evm",
        },
        {
          onChain: true,
          collectionID: "Perion",
          contract: "0x96af92ae2d822a0f191455ceca4d4e7ee227668e",
          chain: "mumbai",
          blockchain: "evm",
        },
        {
          collectionID: "COOLCATS-#2426-14",
          onChain: true,
          contract: "0x3C7e352481F4b2fdEc1e642a3f0018661c77513D",
          chain: "eth",
          openSeaSlug: "devcon-vi-suit-up-collection",
        },
        {
          collectionID: "Town-Hall",
          onChain: true,
          contract: "0x81b30ff521D1fEB67EDE32db726D95714eb00637",
          chain: "Optimism",
        },
      ]);
    }
    function switchTheme() {
      theme = theme === "dark" ? "light" : "dark";
      window.negotiator.switchTheme(theme);
    }
  </script>
</body>

</html>